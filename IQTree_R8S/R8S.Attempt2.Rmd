---
title: "Fast_Tree_R8S.Attempt2"
author: "Tania Kurbessoian"
date: "10/22/2020"
output: pdf_document
---
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{R}
library(ape)
library(phytools)
library(RColorBrewer)
library(ggtree)
library(ggplot2)
library(devtools)
library(deeptime)
library(ggrepel)
library(phangorn)
library(tidytree)
library(treeio)
library(tidyverse)
```

```{R}
#can include r8s files using treeio
#r8s <- read.r8s("/Users/taniakurbessoian/Desktop/TimeTree/r8s_log.txt")
#ggtree(r8s)

#FastTree Documentation
BYTree <- read.tree("r8s.TREE.LONG.tre")
is.ultrametric(BYTree) #just wanted to check


BYTree$root.time <- 485
q = ggtree(BYTree, branch.length="TREE", position = position_nudge(x =-1 * BYTree$root.time)) +
  coord_geo(xlim = c(-490,500), ylim = c(.95,Ntip(BYTree)), neg = TRUE, expand = 5) +
  geom_tiplab(size = 3, align=TRUE, hjust = 1.10) +
  scale_x_continuous(breaks=seq(-485,-25,50), labels=abs(seq(-485,-25,50))) + labs(caption="Divergence time using R8s") + theme_tree2(plot.margin=margin(5, 5, 5, 5))
q
ggsave("FastTree.BY_TimeTree.pdf",q, width=10, height=4)
```

```{R}
IQBY_Tree <-read.tree("Updated.r8s.ROOT.LONG.tre")
IQBY_Tree$root.time <- 485
q = ggtree(IQBY_Tree, branch.length="TREE", position = position_nudge(x =-1 * IQBY_Tree$root.time)) +
  coord_geo(xlim = c(-490,500), ylim = c(.95,Ntip(IQBY_Tree)), neg = TRUE, expand = 5) +
  geom_tiplab(size = 3, align=TRUE, hjust = 1.10) +
  scale_x_continuous(breaks=seq(-485,-25,50), labels=abs(seq(-485,-25,50))) + labs(caption="Divergence time using R8s and IQTree") + theme_tree2(plot.margin=margin(5, 5, 5, 5))
q
ggsave("IQTree.BY_TimeTree.pdf",q, width=10, height=4)
```





